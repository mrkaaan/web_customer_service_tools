# Web Customer Service Tools

使用谷歌浏览器扩产插件写一个工具：
- 工作需要打开多个浏览器（不是多个页签），启动相同淘工厂网页https://c2mbc.service.xixikf.cn/im-desk，每个浏览器登陆不同的账号。
- 给所有淘工厂页面添加一个共同的消息提示框或者叫悬浮窗。
- 每当任意一个浏览器界面出现了新消息（浏览器页面的html元素出现指定元素）或者说新消息数量不为0的时候，悬浮窗出现。
- 在任意浏览器界面出现新的信息时，悬浮窗中的提示也会更新。
- 点击悬浮窗中的某条数据，呼出对应的浏览器的对应页签（窗口置顶 不是打开新的浏览器和标签页）

## 依赖安装

npm install

## 运行

npm run dev

## 结构

1. **浏览器扩展开发**：用于与页面交互和创建悬浮窗。
2. **跨浏览器通信**：确保多个浏览器实例之间的消息同步。
3. **悬浮窗逻辑**：用于显示新消息并处理用户交互。

### 浏览器扩展

谷歌浏览器扩展，使用`manifest.json`定义权限和背景脚本。该扩展将监听网页上的特定元素变化，并向其他浏览器发送通知。

- **Manifest 文件**: 需要声明必要的权限，例如 `"activeTab"`、`"background"` 和 `"notifications"`。
- **内容脚本**: 用于注入到淘工厂网页，监控指定元素的变化 content.js。
- **后台脚本**: 负责管理事件监听器、与内容脚本通信以及与外部服务器通信 backgroud.js。

### 跨浏览器通信

由于浏览器实例是独立的，直接通信可能不是最简单的方法。通过一个中心化的后端服务来中转信息。每个浏览器扩展可以连接到这个服务，并订阅相关的消息更新。

### 悬浮窗逻辑

悬浮窗可以通过浏览器扩展创建，它是一个小型的HTML页面或弹出窗口，由后台脚本控制其显示和隐藏。当有新的消息时，后台脚本会更新悬浮窗的内容，并将其显示出来。

### 后端服务

使用Node.js作为后端，使用WebSocket协议来实现实时双向通信。每个浏览器扩展连接到Node.js服务器，服务器负责分发来自任何客户端的新消息更新。

## 实现步骤概览

1. **建立Node.js WebSocket服务器**：
   - 使用`ws`库或其他WebSocket库来设置服务器。
   - 处理客户端连接、消息接收和广播。

2. **开发浏览器扩展**：
   - 创建`manifest.json`文件配置扩展。
   - 编写内容脚本以监测淘工厂网页上的新消息。
   - 开发后台脚本连接WebSocket服务器，并根据收到的消息更新悬浮窗状态。

3. **实现悬浮窗**：
   - 设计悬浮窗UI，包括如何展示消息和响应点击事件。
   - 在后台脚本中添加逻辑来控制悬浮窗的显示/隐藏及内容更新。

4. **集成所有组件**：
   - 确保内容脚本能够正确检测到新消息并向后台脚本报告。
   - 确保后台脚本能够有效地与WebSocket服务器通信。
   - 测试整个系统的功能，确保多浏览器间的同步工作正常。

5. **测试和部署**：
   - 在真实环境中进行广泛的测试，确保稳定性。
   - 如果一切顺利，可以将扩展发布到Chrome Web Store，或者仅限内部使用。
